<!DOCTYPE html>
<html>
    <head>
        <title>Mead Recipes</title>
        <link rel="stylesheet" href="style.css"/>
    </head>
    <body class="meadBody">
        <!--div for header NEEDS COMPLETED-->
        <div class="header">
            <h1>Mead Recipes</h1>
        </div>

        <!--div for search bar-->
        <div class="search_container">
            <input type="text" id="searchBar" placeholder="Search..." onkeyup="filterTable()">
        </div>
        
        <!--div for recipe table-->
        <div class="tableDiv">
            <table class="table">
                <thead>
                    <tr id="tableHeader">
                        <th></th>
                        <th>Item</th>
                        <th>Effect</th>
                        <th>Duration (s)</th>
                        <th>Recipe</th>
                    </tr>
                </thead>
                <tbody id="meadTable"></tbody>
            </table>
        </div>
                
        <!--div for back button-->
        <div class="backButtonDiv">
            <button class="button" onclick="self.close()">Back to Home Page</button>
        </div>
        
        <script>
            //structure to store json data
            var recipes = [
                {
                    "Item": "Tasty mead",
                    "Effect": "Health regen -50% & stamina regen +300%",
                    "Duration": 10,
                    "Recipe": "10 honey, 10 raspberries, 5 blueberries"
                },
                {
                    "Item": "Minor healing",
                    "Effect": "Restores 50 health",
                    "Duration": 10,
                    "Recipe": "10 honey, 5 blueberries, 10 raspberries, 1 dandelion"
                },
                {
                    "Item": "Medium healing",
                    "Effect": "Restores 75 health",
                    "Duration": 10,
                    "Recipe": "10 honey, 4 bloodbag, 10 raspberries, 1 dandelion"
                },
                {
                    "Item": "Major healing",
                    "Effect": "Restores 125 health",
                    "Duration": 10,
                    "Recipe": "10 honey, 4 blood clot, 5 royal jelly"
                },
                {
                    "Item": "Lingering healing",
                    "Effect": "Health Regen +25%",
                    "Duration": 300,
                    "Recipe": "10 sap, 10 vineberry cluster, 10 smoke puff"
                },
                {
                    "Item": "Minor stamina",
                    "Effect": "Restores 80 stamina",
                    "Duration": 2,
                    "Recipe": "10 honey, 10 raspberries, 10 yellow mushrooms"
                },
                {
                    "Item": "Medium stamina",
                    "Effect": "Restores 150 stamina",
                    "Duration": 2,
                    "Recipe": "10 honey, 10 cloudberries, 10 yellow mushrooms"
                },
                {
                    "Item": "Lingering stamina",
                    "Effect": "Stamina Regen +25%",
                    "Duration": 300,
                    "Recipe": "10 sap, 10 cloudberries, 10 jotun puffs"
                },
                {
                    "Item": "Poison resistance",
                    "Effect": "Poison resistance",
                    "Duration": 600,
                    "Recipe": "10 honey, 5 thistle, 1 neck tail, 10 coal"
                },
                {
                    "Item": "Frost resistance",
                    "Effect": "Frost resistance",
                    "Duration": 600,
                    "Recipe": "10 honey, 5 thistle, 2 bloodbag, 1 greydwarf eye"
                },
                {
                    "Item": "Fire resistance",
                    "Effect": "Fire resistance",
                    "Duration": 600,
                    "Recipe": "10 barley, 10 cloudberries"
                },
                {
                    "Item": "Minor eitr",
                    "Effect": "Restores 125 eitr",
                    "Duration": 10,
                    "Recipe": "10 honey, 5 sap, 2 jotun puffs, 5 magecaps"
                },
                {
                    "Item": "Lingering eitr",
                    "Effect": "Eitr Regen +25%",
                    "Duration": 300,
                    "Recipe": "10 sap, 10 vineberry cluster, 10 magecap"
                }
            ];
            
            //function to initially fill table
            function fillTable(data) {
                var table = document.getElementById('meadTable');
                data.forEach(function(object) {
                    var tr = document.createElement('tr');
                    //handles first abnormal name case
                    if (object.Item == "Tasty mead") {
                        tr.innerHTML = '<th><img src="imgs/mead/' + object.Item.replaceAll(' ','_') + '.png"></th>' +
                        '<td>' + object.Item + '</td>' +
                        '<td>' + object.Effect + '</td>' +
                        '<td>' + object.Duration + '</td>' +
                        '<td>' + object.Recipe + '</td>';
                        table.appendChild(tr);
                    }
                    //handles second abnormal name case
                    else if (object.Item == "Fire resistance") {
                        tr.innerHTML = '<th><img src="imgs/mead/' + object.Item.replaceAll(' ','_') + '_barley_wine.png"></th>' +
                        '<td>' + object.Item + ' barley wine</td>' +
                        '<td>' + object.Effect + '</td>' +
                        '<td>' + object.Duration + '</td>' +
                        '<td>' + object.Recipe + '</td>';
                        table.appendChild(tr);
                    }
                    else {
                        tr.innerHTML = '<th><img src="imgs/mead/' + object.Item.replaceAll(' ','_') + '_mead.png"></th>' +
                        '<td>' + object.Item + ' mead</td>' +
                        '<td>' + object.Effect + '</td>' +
                        '<td>' + object.Duration + '</td>' +
                        '<td>' + object.Recipe + '</td>';
                        table.appendChild(tr);
                    }
                });
            }

            //call function to fill table
            fillTable(recipes);

            //function to filter table by search
            function filterTable() {
                //get user input
                var input = document.getElementById("searchBar");
                var filter = input.value.toLowerCase();
                //get current table data
                var table = document.getElementById("meadTable");
                var rows = table.getElementsByTagName("tr")
                var td;

                //loop to hide rows that don't match filter
                for (var i = 0; i < rows.length; i++) {
                    td = rows[i].getElementsByTagName("td");
                    if (td) {
                        //variable to allow filter by name
                        var item = td[0].innerText;
                        //variable to allow filter by effect
                        var effect = td[1].innerText;
                        //variable to allow filter for ingredient
                        var recipe = td[3].innerText;
                        //display search results for item name, or effect
                        if (item.toLowerCase().includes(filter) || effect.toLowerCase().includes(filter)) {
                            rows[i].style.display = "";
                        }
                        //display search results for recipe
                        else if (recipe.toLowerCase().includes(filter)) {
                            rows[i].style.display = "";
                        }
                        //remove unwanted results from display
                        else {
                            rows[i].style.display = "none";
                        }
                    }

                }
            }
        </script>
    </body>
</html>